
> battleship-game@0.0.0 test
> vitest src/test/MultiplayerFlow.test.tsx


[1m[46m RUN [49m[22m [36mv4.0.13 [39m[90m/System/Volumes/Data/SAPDevelop/battleship-game[39m

[90mstdout[2m | src/test/MultiplayerFlow.test.tsx[2m > [22m[2mMultiplayer Flow Integration[2m > [22m[2mshould switch turns correctly between Host and Guest
[22m[39mSubscribing to room updates: room-1764079372447

[90mstdout[2m | src/test/MultiplayerFlow.test.tsx[2m > [22m[2mMultiplayer Flow Integration[2m > [22m[2mshould switch turns correctly between Host and Guest
[22m[39mSubscribing to room updates: room-1764079372447

[90mstdout[2m | src/test/MultiplayerFlow.test.tsx[2m > [22m[2mMultiplayer Flow Integration[2m > [22m[2mshould switch turns correctly between Host and Guest
[22m[39mTurn mismatch detected! Local: player, Server: opponent. Syncing...

[90mstdout[2m | src/test/MultiplayerFlow.test.tsx[2m > [22m[2mMultiplayer Flow Integration[2m > [22m[2mshould switch turns correctly between Host and Guest
[22m[39mReceived move: {
  id: [32m'move-1764079372449'[39m,
  room_id: [32m'room-1764079372447'[39m,
  player_type: [32m'host'[39m,
  coordinate: { row: [33m0[39m, col: [33m0[39m },
  result: [32m'miss'[39m,
  created_at: [32m'2025-11-25T14:02:52.449Z'[39m
}
Received move: {
  id: [32m'move-1764079372449'[39m,
  room_id: [32m'room-1764079372447'[39m,
  player_type: [32m'host'[39m,
  coordinate: { row: [33m0[39m, col: [33m0[39m },
  result: [32m'miss'[39m,
  created_at: [32m'2025-11-25T14:02:52.449Z'[39m
}
Turn mismatch detected! Local: player, Server: opponent. Syncing...
Turn mismatch detected! Local: opponent, Server: player. Syncing...

[90mstdout[2m | src/test/MultiplayerFlow.test.tsx[2m > [22m[2mMultiplayer Flow Integration[2m > [22m[2mshould switch turns correctly between Host and Guest
[22m[39mReceived move: {
  id: [32m'move-1764079372454'[39m,
  room_id: [32m'room-1764079372447'[39m,
  player_type: [32m'guest'[39m,
  coordinate: { row: [33m0[39m, col: [33m0[39m },
  result: [32m'miss'[39m,
  created_at: [32m'2025-11-25T14:02:52.454Z'[39m
}
Received move: {
  id: [32m'move-1764079372454'[39m,
  room_id: [32m'room-1764079372447'[39m,
  player_type: [32m'guest'[39m,
  coordinate: { row: [33m0[39m, col: [33m0[39m },
  result: [32m'miss'[39m,
  created_at: [32m'2025-11-25T14:02:52.454Z'[39m
}
Turn mismatch detected! Local: opponent, Server: player. Syncing...
Turn mismatch detected! Local: player, Server: opponent. Syncing...

[90mstdout[2m | src/test/MultiplayerFlow.test.tsx[2m > [22m[2mMultiplayer Flow Integration[2m > [22m[2mshould declare winner and sync game over state
[22m[39mSubscribing to room updates: room-1764079372458

[90mstdout[2m | src/test/MultiplayerFlow.test.tsx[2m > [22m[2mMultiplayer Flow Integration[2m > [22m[2mshould declare winner and sync game over state
[22m[39mSubscribing to room updates: room-1764079372458
Subscribing to room updates: room-1764079372458

[90mstdout[2m | src/test/MultiplayerFlow.test.tsx[2m > [22m[2mMultiplayer Flow Integration[2m > [22m[2mshould declare winner and sync game over state
[22m[39mReceived move: {
  id: [32m'move-1764079372458'[39m,
  room_id: [32m'room-1764079372458'[39m,
  player_type: [32m'host'[39m,
  coordinate: { row: [33m0[39m, col: [33m0[39m },
  result: [32m'sunk'[39m,
  created_at: [32m'2025-11-25T14:02:52.458Z'[39m
}
Received move: {
  id: [32m'move-1764079372458'[39m,
  room_id: [32m'room-1764079372458'[39m,
  player_type: [32m'host'[39m,
  coordinate: { row: [33m0[39m, col: [33m0[39m },
  result: [32m'sunk'[39m,
  created_at: [32m'2025-11-25T14:02:52.458Z'[39m
}

[90mstdout[2m | src/test/MultiplayerFlow.test.tsx[2m > [22m[2mMultiplayer Flow Integration[2m > [22m[2mshould declare winner and sync game over state
[22m[39mSubscribing to room updates: room-1764079372458
Subscribing to room updates: room-1764079372458

[90mstdout[2m | src/test/MultiplayerFlow.test.tsx[2m > [22m[2mMultiplayer Flow Integration[2m > [22m[2mshould recover from desynchronized turn state via room update
[22m[39mSubscribing to room updates: room-1764079372463

 [31mâ¯[39m src/test/MultiplayerFlow.test.tsx [2m([22m[2m3 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 1034[2mms[22m[39m
     [32mâœ“[39m should switch turns correctly between Host and Guest[32m 17[2mms[22m[39m
     [32mâœ“[39m should declare winner and sync game over state[32m 5[2mms[22m[39m
[31m     [31mÃ—[31m should recover from desynchronized turn state via room update[39m[33m 1010[2mms[22m[39m

[31mâ¯â¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Tests 1 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m src/test/MultiplayerFlow.test.tsx[2m > [22mMultiplayer Flow Integration[2m > [22mshould recover from desynchronized turn state via room update
[31m[1mAssertionError[22m: expected undefined to be defined

Ignored nodes: comments, script, style
[36m<html>[31m
  [36m<head />[31m
  [36m<body>[31m
    [36m<div />[31m
  [36m</body>[31m
[36m</html>[31m[39m
[36m [2mâ¯[22m src/test/MultiplayerFlow.test.tsx:[2m306:29[22m[39m
    [90m304| [39m                [35mreturn[39m state[33m.[39mcurrentTurn [33m===[39m [32m'player'[39m[33m;[39m
    [90m305| [39m            })[33m;[39m
    [90m306| [39m            [34mexpect[39m(fixCall)[33m.[39m[34mtoBeDefined[39m()[33m;[39m
    [90m   | [39m                            [31m^[39m
    [90m307| [39m        })[33m;[39m
    [90m308| [39m    })[33m;[39m
[90m [2mâ¯[22m runWithExpensiveErrorDiagnosticsDisabled node_modules/@testing-library/dom/dist/config.js:[2m47:12[22m[39m
[90m [2mâ¯[22m checkCallback node_modules/@testing-library/dom/dist/wait-for.js:[2m124:77[22m[39m
[90m [2mâ¯[22m Timeout.checkRealTimersCallback node_modules/@testing-library/dom/dist/wait-for.js:[2m118:16[22m[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/1]â¯[22m[39m


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 15:02:51
[2m   Duration [22m 1.68s[2m (transform 65ms, setup 72ms, collect 108ms, tests 1.03s, environment 379ms, prepare 9ms)[22m

